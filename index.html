<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Carrusel de Blog</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      margin: 0;
      padding: 0;
    }

    h2 {
      text-align: center;
      margin: 30px 0 10px;
    }

    .intro {
      text-align: center;
      padding: 0 20px 20px;
      color: #444;
    }

    .carousel-container {
      width: 100%;
      overflow: hidden;
      position: relative;
      padding: 20px;
      box-sizing: border-box;
    }

    .carousel-track-wrapper {
      overflow: hidden;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.5s ease;
      will-change: transform;
    }

    .blog-card {
      flex: 0 0 33.33%;
      box-sizing: border-box;
      padding: 10px;
    }

    .blog-card a {
      text-decoration: none;
      color: inherit;
    }

    .blog-image {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 10px;
    }

    .blog-title {
      font-size: 16px;
      margin: 10px 0 5px;
      text-align: center;
    }

    .blog-description {
      font-size: 14px;
      color: #555;
      text-align: justify;
      padding: 0 10px;
    }

    .carousel-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.5);
      color: white;
      border: none;
      padding: 10px 15px;
      cursor: pointer;
      z-index: 2;
    }

    .left-button {
      left: 10px;
    }

    .right-button {
      right: 10px;
    }

    .carousel-indicators {
      text-align: center;
      margin-top: 10px;
    }

    .carousel-indicators span {
      display: inline-block;
      width: 10px;
      height: 10px;
      background: #bbb;
      border-radius: 50%;
      margin: 0 5px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    .carousel-indicators .active {
      background: #555;
    }

    @media (max-width: 768px) {
      .blog-card {
        flex: 0 0 100%;
      }

      .blog-image {
        height: 180px;
      }

      .blog-title {
        font-size: 15px;
      }

      .blog-description {
        font-size: 13px;
      }

      .carousel-button {
        display: none;
      }
    }
  </style>
</head>
<body>

  <h2>Últimos Artículos del Blog</h2>
  <div class="intro">
    <p>Descubrí nuestras novedades, consejos y artículos destacados. Hacé clic para leer cada nota completa.</p>
  </div>

  <div class="carousel-container" id="carouselContainer">
    <button class="carousel-button left-button" onclick="moveCarousel(-1)">‹</button>

    <div class="carousel-track-wrapper" id="carouselWrapper">
      <div class="carousel-track" id="carouselTrack">
        <!-- ACA VAN LOS CARDS DEL BLOG (ya incluidos en tu HTML) -->
      </div>
    </div>

    <button class="carousel-button right-button" onclick="moveCarousel(1)">›</button>
  </div>

  <div class="carousel-indicators" id="carouselIndicators"></div>

  <script>
    const track = document.getElementById("carouselTrack");
    const container = document.getElementById("carouselContainer");
    const wrapper = document.getElementById("carouselWrapper");
    const indicators = document.getElementById("carouselIndicators");

    let cards = track.querySelectorAll(".blog-card");
    let currentPosition = 0;
    let autoplayInterval = null;
    let autoplayResumeTimeout = null;

    function getVisibleCards() {
      return window.innerWidth <= 768 ? 1 : 3;
    }

    function updateIndicators() {
      const visible = getVisibleCards();
      const totalDots = Math.ceil(cards.length / visible);
      indicators.innerHTML = "";

      for (let i = 0; i < totalDots; i++) {
        const dot = document.createElement("span");
        if (i === Math.floor(currentPosition / visible)) {
          dot.classList.add("active");
        }
        dot.addEventListener("click", () => {
          currentPosition = i * visible;
          moveCarousel(0);
        });
        indicators.appendChild(dot);
      }
    }

    function restartAutoplayWithDelay() {
      clearInterval(autoplayInterval);
      clearTimeout(autoplayResumeTimeout);
      autoplayResumeTimeout = setTimeout(() => {
        startAutoplay();
      }, 5000); // 5 segundos de pausa
    }

    function moveCarousel(direction) {
      restartAutoplayWithDelay(); // se reinicia autoplay con retardo

      const cardWidth = cards[0].offsetWidth;
      const visibleCards = getVisibleCards();
      const maxPosition = cards.length - visibleCards;

      if (direction !== 0) {
        currentPosition += direction;

        // Scroll infinito
        if (currentPosition < 0) {
          currentPosition = maxPosition;
        } else if (currentPosition > maxPosition) {
          currentPosition = 0;
        }
      }

      const moveX = cardWidth * currentPosition;
      track.style.transform = `translateX(-${moveX}px)`;
      updateIndicators();
    }

    function startAutoplay() {
      autoplayInterval = setInterval(() => {
        moveCarousel(1);
      }, 4000);
    }

    function stopAutoplay() {
      clearInterval(autoplayInterval);
    }

    // Swipe para mobile
    let startX = 0;
    wrapper.addEventListener("touchstart", (e) => {
      startX = e.touches[0].clientX;
      stopAutoplay();
    });

    wrapper.addEventListener("touchend", (e) => {
      const endX = e.changedTouches[0].clientX;
      const diff = endX - startX;

      if (Math.abs(diff) > 50) {
        if (diff > 0) {
          moveCarousel(-1);
        } else {
          moveCarousel(1);
        }
      }

      restartAutoplayWithDelay();
    });

    window.addEventListener("resize", () => {
      moveCarousel(0);
    });

    container.addEventListener("mouseenter", stopAutoplay);
    container.addEventListener("mouseleave", startAutoplay);

    window.addEventListener("DOMContentLoaded", () => {
      cards = track.querySelectorAll(".blog-card");
      moveCarousel(0);
      startAutoplay();
    });
  </script>
</body>
</html>
